Her crate shouldnt be used for punishment. As someone else said try a rolled up newspaper and firm smack on the nose. Also, have your guests hold out a favorite treat of hers and let her approach them. Have her sit (if she does not know sit, most dogs will generally sit after a few minutes of not getting what they know you have). Once she sits (for a few seconds at first, then gradually longer), have them give her the treat. She probably feels that they are a threat to her territory, this will help her to learn that guests need not be feared.