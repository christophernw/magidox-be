you will need to defeat xemnas about 3 times, in differnet forms, but the absolute last is xemnas as a space ship form, once you beat him thats the end after some cut scenes. it ends i think wiht riku stil in the darkness, i can't remember if he leaves the darkness or not. the worlds go back to normal and sora, kairi and riku (possibly) are back on destiny island... donald, goofy and mickey go back to their castle and the worlds are restored.