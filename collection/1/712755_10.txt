I've had a similar problem - a completely random misfire, failure to fire or poor running. Then runs fine for while. It turned out to be a coil.