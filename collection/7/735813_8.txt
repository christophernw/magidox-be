My cat does that when she's in heat.  I have two female cats and the vet told me to get three litter boxes because sometimes cats don't like sharing.  If you only have one cat, maybe consider getting two litter boxes.  Sometimes cats do not like urinating and defecating in the same box.  I bought a great product called OUT.  You can get it at Wal-Mart/K-Mart etc.  After I clean the area she sprayed, I would then spray the OUT on it.  If it's on the fabric, I just let is dry on it's own. If it's on a hard surface, like the window for example, wipe it off.  I think what this does is make the cat think another cat has already marked that spot, so they won't.  Also, if you think your cat is mad because it can't go outside, have you ever tried putting it out on a leash?  My cats love it.. Try this website, this is where I got my info.  www.catsinternational.org   hope this helps